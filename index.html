<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Audio-Image MOS Evaluation</title>

<style>
body {
  font-family: Arial, sans-serif;
  max-width: 1100px;
  margin: auto;
}

.stimulus {
  margin-bottom: 50px;
  padding-bottom: 30px;
  border-bottom: 1px solid #ccc;
}

label {
  display: block;
  margin: 4px 0;
}

img {
  max-width: 900px;
  display: block;
  margin-bottom: 10px;
}

button {
  font-size: 16px;
  padding: 12px 30px;
  margin: 30px 0;
}
</style>
</head>

<body>

<h2>MOS Evaluation #1</h2>
<p>
ë³¸ ì‹¤í—˜ì€ <b>ì˜¤ë””ì˜¤ì˜ í’ˆì§ˆ</b>ê³¼ <b>ì´ë¯¸ì§€ì™€ ì˜¤ë””ì˜¤ì˜ ê´€ë ¨ì„±</b>ì„ ê°ê° 1ì ë¶€í„° 5ì ê¹Œì§€ í‰ê°€í•˜ëŠ” ì‹¤í—˜ì…ë‹ˆë‹¤.
</p>

<p>
ê° ìƒ˜í”Œì€ ì„œë¡œ ë¹„êµí•˜ì§€ ë§ê³ , í•´ë‹¹ ì˜¤ë””ì˜¤ ìƒ˜í”Œì˜ í€„ë¦¬í‹° ë° ì´ë¯¸ì§€ ê´€ë ¨ì„±ë§Œì„ ê¸°ì¤€ìœ¼ë¡œ <b>ì ˆëŒ€ì ì¸ ì ìˆ˜</b>ë¥¼ ë¶€ì—¬í•´ ì£¼ì„¸ìš”.
</p>
<p>
ê° ì˜¤ë””ì˜¤ëŠ” <b>0ì´ˆë¶€í„° 10ì´ˆê¹Œì§€ ì „ì²´ë¥¼ ì²­ì·¨í•œ í›„</b> í‰ê°€í•´ ì£¼ì„¸ìš”.
</p>

<p><b>í‰ê°€ê¸°ì¤€: Audio quality</b></p>
<ul>
  <li>
    5 (Excellent): ì¡ìŒì´ë‚˜ ì™œê³¡ì´ ì—†ëŠ” ìì—°ìŠ¤ëŸ¬ìš´ ì˜¤ë””ì˜¤
  </li>
  <li>
    4 (Good): ì•½ê°„ ë¶€ìì—°ìŠ¤ëŸ¬ìš´ ë¶€ë¶„ì´ ìˆìœ¼ë‚˜ ì „ë°˜ì ìœ¼ë¡œ ìì—°ìŠ¤ëŸ¬ì›Œ ì²­ì·¨ì— í° ë°©í•´ê°€ ë˜ì§€ ì•ŠìŒ
  </li>
  <li>
    3 (Fair): ë¶€ìì—°ìŠ¤ëŸ¬ìš´ ë¶€ë¶„ì´ ë°˜ë³µì ìœ¼ë¡œ ëŠê»´ì§€ë‚˜ ë“¤ì„ ë§Œí•¨
  </li>
  <li>
    2 (Poor): ê¸°ê³„ìŒ ë˜ëŠ” ì™œê³¡ì´ ìì£¼ ë“¤ë¦¬ë©° ì˜¤ë””ì˜¤ë¥¼ ì¸ì‹í•˜ê¸° ì–´ë ¤ì›€
  </li>
  <li>
    1 (Bad): ë§¤ìš° ë¶€ìì—°ìŠ¤ëŸ½ê³  ì˜¤ë””ì˜¤ í’ˆì§ˆì´ ë‚®ìŒ
  </li>
</ul>

<p><b>í‰ê°€ê¸°ì¤€: Image-Audio Relevance</b></p>
<ul>
  <li>
    5 (Excellent): ìƒì„±ëœ ì˜¤ë””ì˜¤ê°€ íƒ€ê²Ÿ ì´ë¯¸ì§€ì˜ ì¥ë©´ì´ë‚˜ ìƒí™©ê³¼ ë§¤ìš° ì˜ ë¶€í•©í•˜ë©°, ì´ë¯¸ì§€ì—ì„œ ê¸°ëŒ€ë˜ëŠ” ì†Œë¦¬ë¥¼ ìì—°ìŠ¤ëŸ½ê²Œ ë°˜ì˜í•¨
  </li>
  <li>
    4 (Good): ì´ë¯¸ì§€ì™€ ì˜¤ë””ì˜¤ê°€ ì „ë°˜ì ìœ¼ë¡œ ì˜ ì–´ìš¸ë¦¬ë‚˜, ì¼ë¶€ë§Œ ì•½ê°„ ì–´ìƒ‰í•¨
  </li>
  <li>
    3 (Fair): ì´ë¯¸ì§€ì™€ ì–´ëŠ ì •ë„ ê´€ë ¨ì€ ìˆìœ¼ë‚˜, ëª…í™•í•˜ì§€ ì•Šê±°ë‚˜ ì• ë§¤í•œ ë¶€ë¶„ì´ ìˆìŒ
  </li>
  <li>
    2 (Poor): ì´ë¯¸ì§€ì™€ ì˜¤ë””ì˜¤ì˜ ê´€ë ¨ì„±ì´ ë‚®ìœ¼ë©°, ê¸°ëŒ€ë˜ëŠ” ì†Œë¦¬ì™€ ë‹¤ë¥¸ ê²½ìš°ê°€ ë§ìŒ
  </li>
  <li>
    1 (Bad): ìƒì„±ëœ ì˜¤ë””ì˜¤ê°€ íƒ€ê²Ÿ ì´ë¯¸ì§€ì™€ ê±°ì˜ ê´€ë ¨ì´ ì—†ìŒ
  </li>
</ul>

<p>
âš ï¸ ì‹¤í—˜ì´ ì¢…ë£Œë˜ë©´ <b>ê²°ê³¼ íŒŒì¼ì´ ìë™ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ</b>ë©ë‹ˆë‹¤. ì‹¤í—˜ ë„ì¤‘ ë¸Œë¼ìš°ì €ë¥¼ ë‹«ì§€ ì•Šë„ë¡ ì£¼ì˜í•´ ì£¼ì„¸ìš”.
</p>
<p>
ğŸ§ ì¡°ìš©í•œ í™˜ê²½ì—ì„œ <b>í—¤ë“œí° ì‚¬ìš©</b>ì„ ê¶Œì¥í•˜ë©°, ê°€ëŠ¥í•œ í•œ ì¢‹ì€ ìŒí–¥ ì¥ë¹„ë¥¼ ì‚¬ìš©í•´ ì£¼ì„¸ìš”.  
</p>


<div id="container"></div>

<button id="nextBtn">Next</button>

<script>
/********************************************************
 * CONFIGURATION
 ********************************************************/

const ITEMS_PER_PAGE = 5;

const stimuli = [
  // 0_ts (v01 ~ v20)
  { id: "v01", image: "./samples/image/0_ts/i_00.jpg", audio: "./samples/audio/0_ts/a_00.wav" },
  { id: "v02", image: "./samples/image/0_ts/i_01.jpg", audio: "./samples/audio/0_ts/a_01.wav" },
  { id: "v03", image: "./samples/image/0_ts/i_02.jpg", audio: "./samples/audio/0_ts/a_02.wav" },
  { id: "v04", image: "./samples/image/0_ts/i_03.jpg", audio: "./samples/audio/0_ts/a_03.wav" },
  { id: "v05", image: "./samples/image/0_ts/i_04.jpg", audio: "./samples/audio/0_ts/a_04.wav" },
  { id: "v06", image: "./samples/image/0_ts/i_05.jpg", audio: "./samples/audio/0_ts/a_05.wav" },
  { id: "v07", image: "./samples/image/0_ts/i_06.jpg", audio: "./samples/audio/0_ts/a_06.wav" },
  { id: "v08", image: "./samples/image/0_ts/i_07.jpg", audio: "./samples/audio/0_ts/a_07.wav" },
  { id: "v09", image: "./samples/image/0_ts/i_08.jpg", audio: "./samples/audio/0_ts/a_08.wav" },
  { id: "v10", image: "./samples/image/0_ts/i_09.jpg", audio: "./samples/audio/0_ts/a_09.wav" },
  { id: "v11", image: "./samples/image/0_ts/i_10.jpg", audio: "./samples/audio/0_ts/a_10.wav" },
  { id: "v12", image: "./samples/image/0_ts/i_11.jpg", audio: "./samples/audio/0_ts/a_11.wav" },
  { id: "v13", image: "./samples/image/0_ts/i_12.jpg", audio: "./samples/audio/0_ts/a_12.wav" },
  { id: "v14", image: "./samples/image/0_ts/i_13.jpg", audio: "./samples/audio/0_ts/a_13.wav" },
  { id: "v15", image: "./samples/image/0_ts/i_14.jpg", audio: "./samples/audio/0_ts/a_14.wav" },
  { id: "v16", image: "./samples/image/0_ts/i_15.jpg", audio: "./samples/audio/0_ts/a_15.wav" },
  { id: "v17", image: "./samples/image/0_ts/i_16.jpg", audio: "./samples/audio/0_ts/a_16.wav" },
  { id: "v18", image: "./samples/image/0_ts/i_17.jpg", audio: "./samples/audio/0_ts/a_17.wav" },
  { id: "v19", image: "./samples/image/0_ts/i_18.jpg", audio: "./samples/audio/0_ts/a_18.wav" },
  { id: "v20", image: "./samples/image/0_ts/i_19.jpg", audio: "./samples/audio/0_ts/a_19.wav" },

  // 1_rms (v21 ~ v40)
  { id: "v21", image: "./samples/image/1_rms/i_00.jpg", audio: "./samples/audio/1_rms/a_00.wav" },
  { id: "v22", image: "./samples/image/1_rms/i_01.jpg", audio: "./samples/audio/1_rms/a_01.wav" },
  { id: "v23", image: "./samples/image/1_rms/i_02.jpg", audio: "./samples/audio/1_rms/a_02.wav" },
  { id: "v24", image: "./samples/image/1_rms/i_03.jpg", audio: "./samples/audio/1_rms/a_03.wav" },
  { id: "v25", image: "./samples/image/1_rms/i_04.jpg", audio: "./samples/audio/1_rms/a_04.wav" },
  { id: "v26", image: "./samples/image/1_rms/i_05.jpg", audio: "./samples/audio/1_rms/a_05.wav" },
  { id: "v27", image: "./samples/image/1_rms/i_06.jpg", audio: "./samples/audio/1_rms/a_06.wav" },
  { id: "v28", image: "./samples/image/1_rms/i_07.jpg", audio: "./samples/audio/1_rms/a_07.wav" },
  { id: "v29", image: "./samples/image/1_rms/i_08.jpg", audio: "./samples/audio/1_rms/a_08.wav" },
  { id: "v30", image: "./samples/image/1_rms/i_09.jpg", audio: "./samples/audio/1_rms/a_09.wav" },
  { id: "v31", image: "./samples/image/1_rms/i_10.jpg", audio: "./samples/audio/1_rms/a_10.wav" },
  { id: "v32", image: "./samples/image/1_rms/i_11.jpg", audio: "./samples/audio/1_rms/a_11.wav" },
  { id: "v33", image: "./samples/image/1_rms/i_12.jpg", audio: "./samples/audio/1_rms/a_12.wav" },
  { id: "v34", image: "./samples/image/1_rms/i_13.jpg", audio: "./samples/audio/1_rms/a_13.wav" },
  { id: "v35", image: "./samples/image/1_rms/i_14.jpg", audio: "./samples/audio/1_rms/a_14.wav" },
  { id: "v36", image: "./samples/image/1_rms/i_15.jpg", audio: "./samples/audio/1_rms/a_15.wav" },
  { id: "v37", image: "./samples/image/1_rms/i_16.jpg", audio: "./samples/audio/1_rms/a_16.wav" },
  { id: "v38", image: "./samples/image/1_rms/i_17.jpg", audio: "./samples/audio/1_rms/a_17.wav" },
  { id: "v39", image: "./samples/image/1_rms/i_18.jpg", audio: "./samples/audio/1_rms/a_18.wav" },
  { id: "v40", image: "./samples/image/1_rms/i_19.jpg", audio: "./samples/audio/1_rms/a_19.wav" },

  // 2_em (v41 ~ v60)
  { id: "v41", image: "./samples/image/2_em/i_00.jpg", audio: "./samples/audio/2_em/a_00.wav" },
  { id: "v42", image: "./samples/image/2_em/i_01.jpg", audio: "./samples/audio/2_em/a_01.wav" },
  { id: "v43", image: "./samples/image/2_em/i_02.jpg", audio: "./samples/audio/2_em/a_02.wav" },
  { id: "v44", image: "./samples/image/2_em/i_03.jpg", audio: "./samples/audio/2_em/a_03.wav" },
  { id: "v45", image: "./samples/image/2_em/i_04.jpg", audio: "./samples/audio/2_em/a_04.wav" },
  { id: "v46", image: "./samples/image/2_em/i_05.jpg", audio: "./samples/audio/2_em/a_05.wav" },
  { id: "v47", image: "./samples/image/2_em/i_06.jpg", audio: "./samples/audio/2_em/a_06.wav" },
  { id: "v48", image: "./samples/image/2_em/i_07.jpg", audio: "./samples/audio/2_em/a_07.wav" },
  { id: "v49", image: "./samples/image/2_em/i_08.jpg", audio: "./samples/audio/2_em/a_08.wav" },
  { id: "v50", image: "./samples/image/2_em/i_09.jpg", audio: "./samples/audio/2_em/a_09.wav" },
  { id: "v51", image: "./samples/image/2_em/i_10.jpg", audio: "./samples/audio/2_em/a_10.wav" },
  { id: "v52", image: "./samples/image/2_em/i_11.jpg", audio: "./samples/audio/2_em/a_11.wav" },
  { id: "v53", image: "./samples/image/2_em/i_12.jpg", audio: "./samples/audio/2_em/a_12.wav" },
  { id: "v54", image: "./samples/image/2_em/i_13.jpg", audio: "./samples/audio/2_em/a_13.wav" },
  { id: "v55", image: "./samples/image/2_em/i_14.jpg", audio: "./samples/audio/2_em/a_14.wav" },
  { id: "v56", image: "./samples/image/2_em/i_15.jpg", audio: "./samples/audio/2_em/a_15.wav" },
  { id: "v57", image: "./samples/image/2_em/i_16.jpg", audio: "./samples/audio/2_em/a_16.wav" },
  { id: "v58", image: "./samples/image/2_em/i_17.jpg", audio: "./samples/audio/2_em/a_17.wav" },
  { id: "v59", image: "./samples/image/2_em/i_18.jpg", audio: "./samples/audio/2_em/a_18.wav" },
  { id: "v60", image: "./samples/image/2_em/i_19.jpg", audio: "./samples/audio/2_em/a_19.wav" }
];


/********************************************************
 * VARIABLES
 ********************************************************/

let trials = [];
let pageIndex = 0;
let results = [];

/********************************************************
 * FUNCTIONS
 ********************************************************/

function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

/* participant-wise randomization */
if (sessionStorage.getItem("ai_mos_trials")) {
  trials = JSON.parse(sessionStorage.getItem("ai_mos_trials"));
} else {
  trials = stimuli.slice();
  shuffle(trials);
  sessionStorage.setItem("ai_mos_trials", JSON.stringify(trials));
}

function createMosBlock(namePrefix) {
  const frag = document.createDocumentFragment();
  for (let score = 5; score >= 1; score--) {
    const label = document.createElement("label");
    const input = document.createElement("input");
    input.type = "radio";
    input.name = namePrefix;
    input.value = score;
    label.appendChild(input);
    label.appendChild(document.createTextNode(" " + score));
    frag.appendChild(label);
  }
  return frag;
}

function loadPage() {
  const container = document.getElementById("container");
  container.innerHTML = "";

  const start = pageIndex * ITEMS_PER_PAGE;
  const current = trials.slice(start, start + ITEMS_PER_PAGE);

  current.forEach((t, idx) => {

    const block = document.createElement("div");
    block.className = "stimulus";

    const title = document.createElement("h4");
    title.textContent = `Item ${start + idx + 1}`;
    block.appendChild(title);

    /* image */
    const img = document.createElement("img");
    img.src = t.image;
    block.appendChild(img);

    /* audio */
    const audio = document.createElement("audio");
    audio.controls = true;
    audio.src = t.audio;
    block.appendChild(audio);

    /* Audio quality */
    const q1 = document.createElement("p");
    q1.innerHTML = "<b>Audio quality:</b>";
    block.appendChild(q1);
    block.appendChild(createMosBlock(`quality_${t.id}`));

    /* Relevance */
    const q2 = document.createElement("p");
    q2.innerHTML = "<b>Imageâ€“Audio relevance:</b>";
    block.appendChild(q2);
    block.appendChild(createMosBlock(`relevance_${t.id}`));

    container.appendChild(block);
  });
}

/********************************************************
 * NEXT BUTTON
 ********************************************************/

document.getElementById("nextBtn").onclick = function () {

  const start = pageIndex * ITEMS_PER_PAGE;
  const current = trials.slice(start, start + ITEMS_PER_PAGE);

  for (const t of current) {
    const q = document.querySelector(`input[name="quality_${t.id}"]:checked`);
    const r = document.querySelector(`input[name="relevance_${t.id}"]:checked`);

    if (!q || !r) {
      alert("Please rate both audio quality and relevance.");
      return;
    }

    results.push({
      stimulus: t.id,
      audio_quality: q.value,
      relevance: r.value,
      page: pageIndex + 1
    });
  }

  pageIndex++;

  if (pageIndex * ITEMS_PER_PAGE < trials.length) {
    loadPage();
  } else {
    finish();
  }
};

/********************************************************
 * FINISH & DOWNLOAD
 ********************************************************/

function finish() {
  let csv = "stimulus,audio_quality,relevance,page\n";

  results.forEach(r => {
    csv += `${r.stimulus},${r.audio_quality},${r.relevance},${r.page}\n`;
  });

  const blob = new Blob([csv], { type: "text/csv" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = "audio_image_mos_results.csv";
  a.click();

  document.body.innerHTML = "<h2>Thank you for your participation.</h2>";
}

loadPage();
</script>

</body>
</html>
